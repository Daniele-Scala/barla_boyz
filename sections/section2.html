<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Data Visualization Project</title>

    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body class="bg-light d-flex flex-column min-vh-100">
    <nav class="navbar navbar-expand-lg navbar-light bg-success">
        <div class="container">
            <a class="navbar-brand" href="../index.html">
                <img src="../Photo/logo.jpg" alt="Logo" height="60">
                <strong>Barla Boyz</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="section1.html"><strong>Section 1</strong></a> 
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="section2.html"><strong>Section 2</strong></a> 
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container text-center flex-grow-1 my-5"> 
        <div class="row">
            <h2>City comparison by heatmap</h2>
            <div id="heatmap"></div>
        </div>
    </div>

    <script>
        d3.json("../Data/dataset1.json").then(function(data) {
            // Estrai le 10 città diverse più popolose
            const topCities = data
                .sort((a, b) => b.count - a.count)
                .map(d => d.city)
                .filter((value, index, self) => self.indexOf(value) === index)
                .slice(0, 10);
            //stampa le città
            console.log(topCities);

            // Estrai i 10 tipi di alberi più presenti
            const topTreeTypes = data
                .sort((a, b) => b.count - a.count)
                .slice(0, 10)
                .map(d => d.scientific_name);

            //stampa gli alberi
            console.log(topTreeTypes);

            // Set up the dimensions of the SVG container and heatmap
            const margin = { top: 20, right: 30, bottom: 30, left: 40 };
            const width = 800 - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;

            // Create an SVG container
            const svg = d3.select("#heatmap")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left}, ${margin.top})`);

            // Create color scales
            const colorScale = d3.scaleSequential(d3.interpolateOranges); // Choose a color scheme

            // Create x and y scales for cities and tree types
            const xScale = d3.scaleBand()
            .domain(topTreeTypes)
            .range([0, width])
            .padding(0.1);

            const yScale = d3.scaleBand()
            .domain(topCities)
            .range([0, height])
            .padding(0.1);

            // Draw the heatmap
            svg.selectAll()
            .data(data) // Use your processed data here
            .enter()
            .append("rect")
            .attr("x", (d) => xScale(d.scientific_name))
            .attr("y", (d) => yScale(`${d.city}, ${d.state}`))
            .attr("width", xScale.bandwidth())
            .attr("height", yScale.bandwidth())
            .style("fill", (d) => colorScale(d.count));

            // Add axes and labels if needed
            const xAxis = d3.axisBottom(xScale);
            svg.append("g")
            .attr("transform", `translate(0, ${height})`)
            .call(xAxis);

            const yAxis = d3.axisLeft(yScale);
            svg.append("g")
            .call(yAxis);

            // Add a legend, title, or other elements as desired

            // Optionally, add interactivity (e.g., tooltips) and animations to enhance the user experience

            // Customize styling, colors, and other visual aspects to fit your specific design

            // Make sure to include the D3.js library in your HTML file


        });
    </script>

    <footer class="bg-dark text-light text-center p-2">
        <p>&copy; 2023 Barla Boyz. Tutti i diritti riservati. <a href="privacy.html" class="text-light">Informativa sulla privacy</a></p>
    </footer>
</body>
</html>